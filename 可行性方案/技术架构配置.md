# é¡¹ç›®æŠ€æœ¯æ¶æ„é…ç½®

> æœ¬æ–‡æ¡£å®šä¹‰äº†é¡¹ç›®çš„æ ‡å‡†æŠ€æœ¯æ¶æ„ï¼Œæ‰€æœ‰ä»£ç ç”Ÿæˆéƒ½åº”éµå¾ªæ­¤æ¶æ„ã€‚

## ğŸ“ æŠ€æœ¯æ ˆæ€»è§ˆ

### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**ï¼šVue 3 + Composition API + TypeScript
- **æ„å»ºå·¥å…·**ï¼šVite 5.x
- **UI ç»„ä»¶åº“**ï¼šVant 4ï¼ˆç§»åŠ¨ç«¯ä¸“ç”¨ï¼‰
- **çŠ¶æ€ç®¡ç†**ï¼šPinia 2.x
- **è·¯ç”±**ï¼šVue Router 4.x
- **HTTP å®¢æˆ·ç«¯**ï¼šAxios 1.x
- **ç§»åŠ¨ç«¯é€‚é…**ï¼špostcss-px-to-viewport

### åç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**ï¼šNestJS 10.x + TypeScript
- **ORM**ï¼šTypeORM 0.3.x
- **æ•°æ®åº“**ï¼šMySQL 8.0
- **ç¼“å­˜**ï¼šRedis 7+ (ä½¿ç”¨ ioredis å®¢æˆ·ç«¯)
- **é‰´æƒ**ï¼šJWT (@nestjs/jwt)
- **API æ–‡æ¡£**ï¼šSwagger (@nestjs/swagger)
- **æ•°æ®éªŒè¯**ï¼šclass-validator + class-transformer

### å¼€å‘å·¥å…·
- **åŒ…ç®¡ç†å™¨**ï¼špnpmï¼ˆæ¨èï¼‰
- **Node.js**ï¼š18.0+ LTS
- **ä»£ç è§„èŒƒ**ï¼šESLint + Prettier
- **ç±»å‹æ£€æŸ¥**ï¼šTypeScript 5.x

---

## ğŸ¯ ä»£ç ç”Ÿæˆè§„èŒƒ

### å‰ç«¯ä»£ç è§„èŒƒ

#### 1. é¡¹ç›®ç»“æ„
```
src/
â”œâ”€â”€ assets/          # é™æ€èµ„æº
â”œâ”€â”€ components/      # å…¬å…±ç»„ä»¶
â”œâ”€â”€ views/           # é¡µé¢ç»„ä»¶
â”œâ”€â”€ router/          # è·¯ç”±é…ç½®
â”œâ”€â”€ stores/          # Pinia çŠ¶æ€ç®¡ç†
â”œâ”€â”€ api/             # API æ¥å£å°è£…
â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°
â”œâ”€â”€ types/           # TypeScript ç±»å‹å®šä¹‰
â””â”€â”€ App.vue          # æ ¹ç»„ä»¶
```

#### 2. Vue 3 ä»£ç é£æ ¼
- ä½¿ç”¨ `<script setup lang="ts">` è¯­æ³•
- ä½¿ç”¨ Composition API
- ä½¿ç”¨ TypeScript ç±»å‹å®šä¹‰
- ç»„ä»¶å‘½åä½¿ç”¨ PascalCase
- æ–‡ä»¶å‘½åä½¿ç”¨ kebab-case

**ç¤ºä¾‹**ï¼š
```vue
<script setup lang="ts">
import { ref, computed } from 'vue'
import { useRouter } from 'vue-router'
import { useUserStore } from '@/stores/user'

interface Props {
  title: string
  count?: number
}

const props = withDefaults(defineProps<Props>(), {
  count: 0
})

const router = useRouter()
const userStore = useUserStore()
</script>

<template>
  <div class="component-name">
    <!-- æ¨¡æ¿å†…å®¹ -->
  </div>
</template>

<style scoped lang="scss">
.component-name {
  // æ ·å¼
}
</style>
```

#### 3. Pinia Store è§„èŒƒ
```typescript
// stores/user.ts
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'
import type { UserInfo } from '@/types/user'
import { getUserInfo } from '@/api/user'

export const useUserStore = defineStore('user', () => {
  const userInfo = ref<UserInfo | null>(null)
  const isLoggedIn = computed(() => !!userInfo.value)

  const fetchUserInfo = async () => {
    const data = await getUserInfo()
    userInfo.value = data
  }

  return {
    userInfo,
    isLoggedIn,
    fetchUserInfo
  }
})
```

#### 4. API å°è£…è§„èŒƒ
```typescript
// api/user.ts
import request from '@/utils/request'
import type { UserInfo, LoginParams } from '@/types/user'

export const getUserInfo = () => {
  return request.get<UserInfo>('/api/user/info')
}

export const login = (params: LoginParams) => {
  return request.post<{ token: string }>('/api/auth/login', params)
}
```

#### 5. è·¯ç”±é…ç½®è§„èŒƒ
```typescript
// router/index.ts
import { createRouter, createWebHistory } from 'vue-router'
import type { RouteRecordRaw } from 'vue-router'

const routes: RouteRecordRaw[] = [
  {
    path: '/',
    name: 'Home',
    component: () => import('@/views/Home.vue'),
    meta: {
      title: 'é¦–é¡µ',
      requiresAuth: false
    }
  }
]

const router = createRouter({
  history: createWebHistory(),
  routes
})

export default router
```

### åç«¯ä»£ç è§„èŒƒ

#### 1. é¡¹ç›®ç»“æ„
```
src/
â”œâ”€â”€ main.ts              # åº”ç”¨å…¥å£
â”œâ”€â”€ app.module.ts        # æ ¹æ¨¡å—
â”œâ”€â”€ common/              # å…¬å…±æ¨¡å—
â”‚   â”œâ”€â”€ decorators/      # è‡ªå®šä¹‰è£…é¥°å™¨
â”‚   â”œâ”€â”€ filters/         # å¼‚å¸¸è¿‡æ»¤å™¨
â”‚   â”œâ”€â”€ guards/          # å®ˆå«
â”‚   â””â”€â”€ interceptors/    # æ‹¦æˆªå™¨
â”œâ”€â”€ config/              # é…ç½®æ–‡ä»¶
â”œâ”€â”€ modules/             # ä¸šåŠ¡æ¨¡å—
â”‚   â”œâ”€â”€ user/            # ç”¨æˆ·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ user.module.ts
â”‚   â”‚   â”œâ”€â”€ user.controller.ts
â”‚   â”‚   â”œâ”€â”€ user.service.ts
â”‚   â”‚   â”œâ”€â”€ user.entity.ts
â”‚   â”‚   â””â”€â”€ dto/         # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â””â”€â”€ auth/            # è®¤è¯æ¨¡å—
â”œâ”€â”€ database/            # æ•°æ®åº“é…ç½®
â”‚   â””â”€â”€ migrations/      # æ•°æ®åº“è¿ç§»
â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
```

#### 2. Controller è§„èŒƒ
```typescript
// modules/user/user.controller.ts
import { Controller, Get, Post, Body, UseGuards } from '@nestjs/common'
import { ApiTags, ApiOperation, ApiBearerAuth } from '@nestjs/swagger'
import { JwtAuthGuard } from '@/common/guards/jwt-auth.guard'
import { UserService } from './user.service'
import { CreateUserDto } from './dto/create-user.dto'

@ApiTags('ç”¨æˆ·')
@Controller('user')
@UseGuards(JwtAuthGuard)
@ApiBearerAuth()
export class UserController {
  constructor(private readonly userService: UserService) {}

  @Get('info')
  @ApiOperation({ summary: 'è·å–ç”¨æˆ·ä¿¡æ¯' })
  async getUserInfo() {
    return this.userService.getUserInfo()
  }

  @Post()
  @ApiOperation({ summary: 'åˆ›å»ºç”¨æˆ·' })
  async create(@Body() createUserDto: CreateUserDto) {
    return this.userService.create(createUserDto)
  }
}
```

#### 3. Service è§„èŒƒ
```typescript
// modules/user/user.service.ts
import { Injectable } from '@nestjs/common'
import { InjectRepository } from '@nestjs/typeorm'
import { Repository } from 'typeorm'
import { User } from './user.entity'
import { CreateUserDto } from './dto/create-user.dto'

@Injectable()
export class UserService {
  constructor(
    @InjectRepository(User)
    private userRepository: Repository<User>
  ) {}

  async getUserInfo() {
    return this.userRepository.find()
  }

  async create(createUserDto: CreateUserDto) {
    const user = this.userRepository.create(createUserDto)
    return this.userRepository.save(user)
  }
}
```

#### 4. Entity è§„èŒƒ
```typescript
// modules/user/user.entity.ts
import { Entity, Column, PrimaryGeneratedColumn, CreateDateColumn, UpdateDateColumn } from 'typeorm'

@Entity('users')
export class User {
  @PrimaryGeneratedColumn()
  id: number

  @Column({ length: 50 })
  username: string

  @Column({ length: 100 })
  email: string

  @CreateDateColumn()
  createdAt: Date

  @UpdateDateColumn()
  updatedAt: Date
}
```

#### 5. DTO è§„èŒƒ
```typescript
// modules/user/dto/create-user.dto.ts
import { IsString, IsEmail, IsNotEmpty, MinLength } from 'class-validator'
import { ApiProperty } from '@nestjs/swagger'

export class CreateUserDto {
  @ApiProperty({ description: 'ç”¨æˆ·å', example: 'john_doe' })
  @IsString()
  @IsNotEmpty()
  @MinLength(3)
  username: string

  @ApiProperty({ description: 'é‚®ç®±', example: 'john@example.com' })
  @IsEmail()
  @IsNotEmpty()
  email: string

  @ApiProperty({ description: 'å¯†ç ', example: 'password123' })
  @IsString()
  @IsNotEmpty()
  @MinLength(6)
  password: string
}
```

#### 6. Module è§„èŒƒ
```typescript
// modules/user/user.module.ts
import { Module } from '@nestjs/common'
import { TypeOrmModule } from '@nestjs/typeorm'
import { UserController } from './user.controller'
import { UserService } from './user.service'
import { User } from './user.entity'

@Module({
  imports: [TypeOrmModule.forFeature([User])],
  controllers: [UserController],
  providers: [UserService],
  exports: [UserService]
})
export class UserModule {}
```

#### 7. Redis ä½¿ç”¨è§„èŒƒ
```typescript
// ä½¿ç”¨ ioredis
import { Injectable, Inject } from '@nestjs/common'
import Redis from 'ioredis'

@Injectable()
export class CacheService {
  constructor(
    @Inject('REDIS_CLIENT') private readonly redis: Redis
  ) {}

  async set(key: string, value: string, ttl?: number) {
    if (ttl) {
      return this.redis.setex(key, ttl, value)
    }
    return this.redis.set(key, value)
  }

  async get(key: string) {
    return this.redis.get(key)
  }
}
```

---

## ğŸ“¦ ä¾èµ–ç‰ˆæœ¬é”å®š

### å‰ç«¯æ ¸å¿ƒä¾èµ–
```json
{
  "vue": "^3.4.0",
  "vue-router": "^4.2.0",
  "pinia": "^2.1.0",
  "axios": "^1.6.0",
  "vant": "^4.8.0",
  "@vitejs/plugin-vue": "^5.0.0",
  "vite": "^5.0.0",
  "typescript": "^5.3.0"
}
```

### åç«¯æ ¸å¿ƒä¾èµ–
```json
{
  "@nestjs/common": "^10.3.0",
  "@nestjs/core": "^10.3.0",
  "@nestjs/typeorm": "^10.0.0",
  "@nestjs/jwt": "^10.2.0",
  "@nestjs/swagger": "^7.1.0",
  "typeorm": "^0.3.17",
  "mysql2": "^3.6.0",
  "ioredis": "^5.3.0"
}
```

---

## ğŸ”§ é…ç½®æ–‡ä»¶æ¨¡æ¿

### Vite é…ç½®
```typescript
// vite.config.ts
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import { resolve } from 'path'

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src')
    }
  },
  server: {
    port: 5173,
    proxy: {
      '/api': {
        target: 'http://localhost:3000',
        changeOrigin: true
      }
    }
  }
})
```

### TypeORM é…ç½®
```typescript
// config/database.config.ts
import { TypeOrmModuleOptions } from '@nestjs/typeorm'

export const databaseConfig: TypeOrmModuleOptions = {
  type: 'mysql',
  host: process.env.DB_HOST || 'localhost',
  port: parseInt(process.env.DB_PORT) || 3306,
  username: process.env.DB_USER || 'root',
  password: process.env.DB_PASSWORD || '',
  database: process.env.DB_NAME || 'h5_db',
  entities: [__dirname + '/../**/*.entity{.ts,.js}'],
  synchronize: false, // ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä¸º false
  logging: process.env.NODE_ENV === 'development'
}
```

---

## âœ… ä»£ç ç”Ÿæˆæ£€æŸ¥æ¸…å•

ç”Ÿæˆä»£ç æ—¶ï¼Œç¡®ä¿ï¼š

### å‰ç«¯
- [ ] ä½¿ç”¨ Vue 3 Composition API + `<script setup>`
- [ ] ä½¿ç”¨ TypeScript ç±»å‹å®šä¹‰
- [ ] ä½¿ç”¨ Vant ç»„ä»¶åº“ï¼ˆç§»åŠ¨ç«¯ï¼‰
- [ ] ä½¿ç”¨ Pinia è¿›è¡ŒçŠ¶æ€ç®¡ç†
- [ ] API è°ƒç”¨ä½¿ç”¨ Axios å°è£…
- [ ] è·¯ç”±ä½¿ç”¨ Vue Router 4
- [ ] éµå¾ªé¡¹ç›®ç›®å½•ç»“æ„

### åç«¯
- [ ] ä½¿ç”¨ NestJS æ¡†æ¶
- [ ] ä½¿ç”¨ TypeORM æ“ä½œæ•°æ®åº“
- [ ] ä½¿ç”¨ ioredis æ“ä½œ Redis
- [ ] ä½¿ç”¨ JWT è¿›è¡Œé‰´æƒ
- [ ] ä½¿ç”¨ class-validator è¿›è¡Œæ•°æ®éªŒè¯
- [ ] ä½¿ç”¨ Swagger è£…é¥°å™¨ç”Ÿæˆ API æ–‡æ¡£
- [ ] éµå¾ªæ¨¡å—åŒ–ç›®å½•ç»“æ„
- [ ] Entityã€DTOã€Controllerã€Service åˆ†ç¦»

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **ORM é€‰æ‹©**ï¼šç»Ÿä¸€ä½¿ç”¨ TypeORMï¼Œä¸ä½¿ç”¨ Prisma
2. **Redis å®¢æˆ·ç«¯**ï¼šç»Ÿä¸€ä½¿ç”¨ ioredisï¼Œä¸ä½¿ç”¨ node-redis
3. **åŒ…ç®¡ç†å™¨**ï¼šä¼˜å…ˆä½¿ç”¨ pnpm
4. **ä»£ç é£æ ¼**ï¼šéµå¾ª ESLint + Prettier é…ç½®
5. **ç±»å‹å®‰å…¨**ï¼šæ‰€æœ‰ä»£ç å¿…é¡»ä½¿ç”¨ TypeScript
6. **API æ–‡æ¡£**ï¼šæ‰€æœ‰æ¥å£å¿…é¡»æ·»åŠ  Swagger è£…é¥°å™¨

---

**æœ€åæ›´æ–°**ï¼š2024å¹´
**ç»´æŠ¤è€…**ï¼šå¼€å‘å›¢é˜Ÿ

