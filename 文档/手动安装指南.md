# 手动安装 Homebrew 和 MySQL 指南

由于自动安装需要交互式输入密码，请按照以下步骤手动操作：

## 步骤 1: 安装 Homebrew（使用国内镜像）

在终端中执行以下命令（**需要输入管理员密码**）：

```bash
/bin/bash -c "$(curl -fsSL https://gitee.com/ineo6/homebrew-install/raw/master/install.sh)"
```

安装过程中：
1. 会提示输入管理员密码
2. 按回车键确认
3. 等待安装完成

安装完成后，根据提示添加到 PATH：

**Apple Silicon (M1/M2/M3):**
```bash
echo 'eval "$(/opt/homebrew/bin/brew shellenv)"' >> ~/.zprofile
eval "$(/opt/homebrew/bin/brew shellenv)"
```

**Intel 芯片:**
```bash
echo 'eval "$(/usr/local/bin/brew shellenv)"' >> ~/.zprofile
eval "$(/usr/local/bin/brew shellenv)"
```

验证安装：
```bash
brew --version
```

## 步骤 2: 配置 Homebrew 镜像源（可选但推荐）

```bash
# 替换 brew.git
git -C "$(brew --repo)" remote set-url origin https://mirrors.ustc.edu.cn/brew.git

# 替换 homebrew-core.git
git -C "$(brew --repo homebrew/core)" remote set-url origin https://mirrors.ustc.edu.cn/homebrew-core.git

# 更新 Homebrew
brew update
```

## 步骤 3: 安装 MySQL

```bash
brew install mysql
```

这可能需要几分钟时间，请耐心等待。

## 步骤 4: 启动 MySQL 服务

```bash
brew services start mysql
```

检查服务状态：
```bash
brew services list | grep mysql
```

应该看到 `started` 状态。

## 步骤 5: 设置 MySQL root 密码（首次安装）

```bash
mysql_secure_installation
```

按照提示：
- 设置 root 密码（建议使用强密码）
- 移除匿名用户（输入 Y）
- 禁止 root 远程登录（输入 Y）
- 移除 test 数据库（输入 Y）
- 重新加载权限表（输入 Y）

## 步骤 6: 创建数据库

```bash
# 方式 1: 如果设置了密码
mysql -u root -p -e "CREATE DATABASE h5_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"

# 方式 2: 如果没有密码（首次安装可能没有）
mysql -u root -e "CREATE DATABASE h5_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"
```

## 验证数据库创建成功

```bash
mysql -u root -p -e "SHOW DATABASES LIKE 'h5_db';"
```

应该看到：
```
+------------------+
| Database (h5_db) |
+------------------+
| h5_db            |
+------------------+
```

## 如果遇到问题

### 问题 1: Homebrew 安装失败

- 检查网络连接
- 尝试使用代理
- 或使用其他镜像源（清华、阿里云等）

### 问题 2: MySQL 服务无法启动

```bash
# 查看错误日志
tail -f /opt/homebrew/var/mysql/*.err
# 或
tail -f /usr/local/var/mysql/*.err

# 重启服务
brew services restart mysql
```

### 问题 3: 忘记 MySQL root 密码

参考 `创建数据库.md` 中的密码重置步骤。

## 完成后的配置

数据库创建成功后，在 `backend` 目录创建 `.env` 文件：

```env
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=你设置的密码
DB_NAME=h5_db
```

然后就可以启动后端服务了！

